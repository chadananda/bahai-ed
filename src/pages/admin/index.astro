---
export const prerender = false;

import { db, eq, Team } from 'astro:db';
import Layout from '@layouts/AdminLayout.astro';

const user = Astro.locals.user;
const member = !!(await db.select().from(Team).where(eq(Team.email, user.email)))[0];

// user must be a team member in order to use admin area
if (!member) return Astro.redirect('/login');
---
<Layout user={user} >
  <div class="mx-auto text-center w-full">

    <h1 class="text-xl"> Admin Dashboard: {user?.role} </h1>

    {user && (
      <pre>{JSON.stringify(user, null, 2)}</pre>
    )}
    {!user && (
      <h2 class="text-lg"> No user object found </h2>
    )}
 </div>
</Layout>


